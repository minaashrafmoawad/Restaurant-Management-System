@* @model IEnumerable<RestaurantManagementSystem.Domain.Models.Table> *@

@* @{ *@
@*     ViewData["Title"] = "Tables"; *@
@* } *@

@* <div class="container-fluid"> *@
@*     <div class="row"> *@
@*         <div class="col-12"> *@
@*             <div class="d-flex justify-content-between align-items-center mb-4"> *@
@*                 <h2 class="mb-0"> *@
@*                     <i class="fas fa-table text-primary me-2"></i> *@
@*                     Tables Management *@
@*                 </h2> *@
@*                 <div> *@
@*                     <a asp-action="Available" class="btn btn-info me-2"> *@
@*                         <i class="fas fa-check-circle me-2"></i>Available Tables *@
@*                     </a> *@
@*                     <a asp-action="Create" class="btn btn-primary"> *@
@*                         <i class="fas fa-plus me-2"></i>Add New Table *@
@*                     </a> *@
@*                 </div> *@
@*             </div> *@

@*             @if (TempData["SuccessMessage"] != null) *@
@*             { *@
@*                 <div class="alert alert-success alert-dismissible fade show" role="alert"> *@
@*                     <i class="fas fa-check-circle me-2"></i> *@
@*                     @TempData["SuccessMessage"] *@
@*                     <button type="button" class="btn-close" data-bs-dismiss="alert"></button> *@
@*                 </div> *@
@*             } *@

@*             @if (TempData["ErrorMessage"] != null) *@
@*             { *@
@*                 <div class="alert alert-danger alert-dismissible fade show" role="alert"> *@
@*                     <i class="fas fa-exclamation-circle me-2"></i> *@
@*                     @TempData["ErrorMessage"] *@
@*                     <button type="button" class="btn-close" data-bs-dismiss="alert"></button> *@
@*                 </div> *@
@*             } *@

@*             <div class="card shadow"> *@
@*                 <div class="card-body"> *@
@*                     @if (Model.Any()) *@
@*                     { *@
@*                         <div class="table-responsive"> *@
@*                             <table class="table table-hover"> *@
@*                                 <thead class="table-dark"> *@
@*                                     <tr> *@
@*                                         <th>Table Number</th> *@
@*                                         <th>Capacity</th> *@
@*                                         <th>Availability</th> *@
@*                                         <th>Created Date</th> *@
@*                                         <th>Status</th> *@
@*                                         <th class="text-center">Actions</th> *@
@*                                     </tr> *@
@*                                 </thead> *@
@*                                 <tbody> *@
@*                                     @foreach (var item in Model.OrderBy(t => t.Number)) *@
@*                                     { *@
@*                                         <tr> *@
@*                                             <td> *@
@*                                                 <strong class="text-primary fs-5">Table #@item.Number</strong> *@
@*                                             </td> *@
@*                                             <td> *@
@*                                                 <i class="fas fa-users me-1"></i> *@
@*                                                 @item.Capacity person(s) *@
@*                                             </td> *@
@*                                             <td> *@
@*                                                 <div class="form-check form-switch"> *@
@*                                                     <input class="form-check-input availability-toggle" *@
@*                                                            type="checkbox" *@
@*                                                     @(item.IsAvailable ? "checked" : "") *@
@*                                                            data-table-id="@item.Id" *@
@*                                                            id="availability-@item.Id"> *@
@*                                                     <label class="form-check-label" for="availability-@item.Id"> *@
@*                                                         @if (item.IsAvailable) *@
@*                                                         { *@
@*                                                             <span class="badge bg-success">Available</span> *@
@*                                                         } *@
@*                                                         else *@
@*                                                         { *@
@*                                                             <span class="badge bg-danger">Occupied</span> *@
@*                                                         } *@
@*                                                     </label> *@
@*                                                 </div> *@
@*                                             </td> *@
@*                                             <td> *@
@*                                                 <small class="text-muted"> *@
@*                                                     @item.CreatedDate.ToString("MMM dd, yyyy") *@
@*                                                 </small> *@
@*                                             </td> *@
@*                                             <td> *@
@*                                                 @if (!item.IsDeleted) *@
@*                                                 { *@
@*                                                     <span class="badge bg-success">Active</span> *@
@*                                                 } *@
@*                                                 else *@
@*                                                 { *@
@*                                                     <span class="badge bg-danger">Deleted</span> *@
@*                                                 } *@
@*                                             </td> *@
@*                                             <td class="text-center"> *@
@*                                                 <div class="btn-group" role="group"> *@
@*                                                     <a asp-action="Details" asp-route-id="@item.Id" *@
@*                                                        class="btn btn-sm btn-outline-info" title="View Details"> *@
@*                                                         <i class="fas fa-eye"></i> *@
@*                                                     </a> *@
@*                                                     <a asp-action="Edit" asp-route-id="@item.Id" *@
@*                                                        class="btn btn-sm btn-outline-warning" title="Edit"> *@
@*                                                         <i class="fas fa-edit"></i> *@
@*                                                     </a> *@
@*                                                     <a asp-action="Delete" asp-route-id="@item.Id" *@
@*                                                        class="btn btn-sm btn-outline-danger" title="Delete"> *@
@*                                                         <i class="fas fa-trash"></i> *@
@*                                                     </a> *@
@*                                                 </div> *@
@*                                             </td> *@
@*                                         </tr> *@
@*                                     } *@
@*                                 </tbody> *@
@*                             </table> *@
@*                         </div> *@

@*                         <div class="row mt-4"> *@
@*                             <div class="col-md-3"> *@
@*                                 <div class="card bg-light"> *@
@*                                     <div class="card-body text-center"> *@
@*                                         <h5>Total Tables</h5> *@
@*                                         <h3 class="text-primary">@Model.Count()</h3> *@
@*                                     </div> *@
@*                                 </div> *@
@*                             </div> *@
@*                             <div class="col-md-3"> *@
@*                                 <div class="card bg-success text-white"> *@
@*                                     <div class="card-body text-center"> *@
@*                                         <h5>Available</h5> *@
@*                                         <h3>@Model.Count(t => t.IsAvailable)</h3> *@
@*                                     </div> *@
@*                                 </div> *@
@*                             </div> *@
@*                             <div class="col-md-3"> *@
@*                                 <div class="card bg-danger text-white"> *@
@*                                     <div class="card-body text-center"> *@
@*                                         <h5>Occupied</h5> *@
@*                                         <h3>@Model.Count(t => !t.IsAvailable)</h3> *@
@*                                     </div> *@
@*                                 </div> *@
@*                             </div> *@
@*                             <div class="col-md-3"> *@
@*                                 <div class="card bg-info text-white"> *@
@*                                     <div class="card-body text-center"> *@
@*                                         <h5>Total Capacity</h5> *@
@*                                         <h3>@Model.Sum(t => t.Capacity)</h3> *@
@*                                     </div> *@
@*                                 </div> *@
@*                             </div> *@
@*                         </div> *@
@*                     } *@
@*                     else *@
@*                     { *@
@*                         <div class="text-center py-5"> *@
@*                             <i class="fas fa-table fa-3x text-muted mb-3"></i> *@
@*                             <h4 class="text-muted">No Tables Found</h4> *@
@*                             <p class="text-muted">Start by adding your first table.</p> *@
@*                             <a asp-action="Create" class="btn btn-primary"> *@
@*                                 <i class="fas fa-plus me-2"></i>Create First Table *@
@*                             </a> *@
@*                         </div> *@
@*                     } *@
@*                 </div> *@
@*             </div> *@
@*         </div> *@
@*     </div> *@
@* </div> *@

@* @section Scripts { *@
@*     <script> *@
@*         $(document).ready(function() { *@
@*             $('.availability-toggle').change(function() { *@
@*                 var tableId = $(this).data('table-id'); *@
@*                 var isAvailable = $(this).is(':checked'); *@
@*                 var toggleSwitch = $(this); *@
@*                 var label = toggleSwitch.next('label').find('.badge'); *@

@*                 $.ajax({ *@
@*                     url: '@Url.Action("UpdateAvailability", "Table")', *@
@*                     method: 'POST', *@
@*                     data: { *@
@*                         id: tableId, *@
@*                         isAvailable: isAvailable *@
@*                     }, *@
@*                     success: function(response) { *@
@*                         if (response.success) { *@
@*                             // Update the badge *@
@*                             if (isAvailable) { *@
@*                                 label.removeClass('bg-danger').addClass('bg-success').text('Available'); *@
@*                             } else { *@
@*                                 label.removeClass('bg-success').addClass('bg-danger').text('Occupied'); *@
@*                             } *@

@*                             // Show success message *@
@*                             showToast('success', response.message); *@
@*                         } else { *@
@*                             // Revert the switch *@
@*                             toggleSwitch.prop('checked', !isAvailable); *@
@*                             showToast('error', response.message); *@
@*                         } *@
@*                     }, *@
@*                     error: function() { *@
@*                         // Revert the switch *@
@*                         toggleSwitch.prop('checked', !isAvailable); *@
@*                         showToast('error', 'An error occurred while updating table availability.'); *@
@*                     } *@
@*                 }); *@
@*             }); *@
@*         }); *@

@*         function showToast(type, message) { *@
@*             // Simple toast notification (you can replace with your preferred toast library) *@
@*             var alertClass = type === 'success' ? 'alert-success' : 'alert-danger'; *@
@*             var icon = type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'; *@

@*             var toast = $('<div class="alert ' + alertClass + ' alert-dismissible fade show position-fixed" style="top: 20px; right: 20px; z-index: 9999;">' + *@
@*                 '<i class="fas ' + icon + ' me-2"></i>' + message + *@
@*                 '<button type="button" class="btn-close" data-bs-dismiss="alert"></button>' + *@
@*                 '</div>'); *@

@*             $('body').append(toast); *@

@*             setTimeout(function() { *@
@*                 toast.alert('close'); *@
@*             }, 3000); *@
@*         } *@
@*     </script> *@
@* } *@







@model IEnumerable<RestaurantManagementSystem.Domain.Models.Table>

@{
    ViewData["Title"] = "Tables";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="mb-0">
                    <i class="fas fa-utensils text-primary me-2"></i>
                    Tables Management
                </h2>
                <a asp-action="Create" class="btn btn-primary">
                    <i class="fas fa-plus me-2"></i>Add New Table
                </a>
            </div>

            @if (TempData["SuccessMessage"] != null)
            {
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    <i class="fas fa-check-circle me-2"></i>
                    @TempData["SuccessMessage"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            }

            @if (TempData["ErrorMessage"] != null)
            {
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    @TempData["ErrorMessage"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            }

            <div class="card shadow">
                <div class="card-body">
                    @if (Model.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Table Number</th>
                                        <th>Capacity</th>
                                        <th>Status</th>
                                        <th>Created Date</th>
                                        <th class="text-center">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model)
                                    {
                                        <tr>
                                            <td>
                                                <strong class="text-primary">Table @Html.DisplayFor(modelItem => item.Number)</strong>
                                            </td>
                                            <td>
                                                <span class="badge bg-info">@item.Capacity @(item.Capacity == 1 ? "person" : "people")</span>
                                            </td>
                                            <td>
                                                @if (item.IsAvailable)
                                                {
                                                    <span class="badge bg-success">Available</span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-warning text-dark">Occupied</span>
                                                }
                                                @if (item.IsDeleted)
                                                {
                                                    <span class="badge bg-danger ms-1">Deleted</span>
                                                }
                                            </td>
                                            <td>
                                                <small class="text-muted">
                                                    @item.CreatedDate.ToString("MMM dd, yyyy")
                                                </small>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group" role="group">
                                                    <a asp-action="Details" asp-route-id="@item.Id"
                                                       class="btn btn-sm btn-outline-info" title="Details">
                                                        Details
                                                        <i class="fas fa-eye"></i>
                                                    </a>
                                                    <a asp-action="Edit" asp-route-id="@item.Id"
                                                       class="btn btn-sm btn-outline-warning" title="Edit">
                                                        Edit
                                                        <i class="fas fa-edit"></i>
                                                    </a>
                                                    <a asp-action="Delete" asp-route-id="@item.Id"
                                                       class="btn btn-sm btn-outline-danger" title="Delete">
                                                        Delete
                                                        <i class="fas fa-trash"></i>
                                                    </a>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="text-center py-5">
                            <i class="fas fa-utensils fa-3x text-muted mb-3"></i>
                            <h4 class="text-muted">No Tables Found</h4>
                            <p class="text-muted">Start by creating your first table.</p>
                            <a asp-action="Create" class="btn btn-primary">
                                <i class="fas fa-plus me-2"></i>Create First Table
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>