@model RestaurantManagementSystem.Domain.Models.Order
@using RestaurantManagementSystem.Domain.Enums

@{
    ViewData["Title"] = "Order Details";
}

<h1>Order Details</h1>

@if (Model != null)
{
    <div class="card rounded">
        <div class="card-header bg-primary text-white rounded-top">
            Order #@Model.Id.ToString().Substring(0, 8)
        </div>
        <div class="card-body">
            <dl class="row">
                <dt class="col-sm-3">Order Type:</dt>
                <dd class="col-sm-9">@Model.Type</dd>

                <dt class="col-sm-3">Status:</dt>
                <dd class="col-sm-9">@Model.Status</dd>

                <dt class="col-sm-3">Total Amount:</dt>
                <dd class="col-sm-9">@Model.TotalAmount.ToString("C")</dd>

                <dt class="col-sm-3">Order Date:</dt>
                <dd class="col-sm-9">@Model.CreatedDate.ToShortDateString() @Model.CreatedDate.ToShortTimeString()</dd>

                @if (!string.IsNullOrEmpty(Model.SpecialInstructions))
                {
                    <dt class="col-sm-3">Special Instructions:</dt>
                    <dd class="col-sm-9">@Model.SpecialInstructions</dd>
                }

                @if (Model.Type == OrderType.Delivery && !string.IsNullOrEmpty(Model.DeliveryAddress))
                {
                    <dt class="col-sm-3">Delivery Address:</dt>
                    <dd class="col-sm-9">@Model.DeliveryAddress</dd>
                    <dt class="col-sm-3">Estimated Delivery Time:</dt>
                    <dd class="col-sm-9">@(Model.EstimatedDeliveryTime?.ToString("g") ?? "N/A")</dd>
                    <dt class="col-sm-3">Actual Delivery Time:</dt>
                    <dd class="col-sm-9">@(Model.ActualDeliveryTime?.ToString("g") ?? "N/A")</dd>
                }

                @if (Model.Type == OrderType.Takeout && Model.PickupTime.HasValue)
                {
                    <dt class="col-sm-3">Pickup Time:</dt>
                    <dd class="col-sm-9">@Model.PickupTime?.ToString("g")</dd>
                }
            </dl>

            <h5 class="mt-4">Order Items:</h5>
            @if (Model.OrderItems != null && Model.OrderItems.Any())
            {
                <table class="table table-striped rounded">
                    <thead>
                        <tr>
                            <th>Item Name</th>
                            <th>Quantity</th>
                            <th>Unit Price</th>
                            <th>Total</th>
                            <th>Instructions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.OrderItems)
                        {
                            <tr>
                                <td>@(item.MenuItem?.Name ?? "N/A")</td>
                                <td>@item.Quantity</td>
                                <td>@item.UnitPrice.ToString("C")</td>
                                <td>@((item.Quantity * item.UnitPrice).ToString("C"))</td>
                                <td>@(item.SpecialInstructions ?? "None")</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p>No items in this order.</p>
            }
        </div>
        <div class="card-footer rounded-bottom">
            <a asp-action="Kitchen" class="btn btn-secondary rounded">Back to Kitchen</a>
        </div>
    </div>
}
else
{
    <div class="alert alert-warning rounded">
        <p>Order not found.</p>
    </div>
    <a asp-action="Kitchen" class="btn btn-secondary rounded">Back to Kitchen</a>
}